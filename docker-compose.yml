services:
  # Base de donn√©es PostgreSQL
  servicedating.db:
    image: 'postgres:latest'
    env_file: ./webApp/back.env
    ports:
      - '5432:5432'
    volumes:
      - ./webApp/app/sql:/var/sql
    restart: always


  # Backend Symfony API
  servicedating.backend:
    build:
      context: ./
      dockerfile: ./webApp/build/Dockerfile.backend
    container_name: servicedating-backend
    ports:
      - "8889:8000"
    command: symfony server:start --no-tls --port=8000 --allow-http --no-interaction --ansi --listen-ip=0.0.0.0
    depends_on:
      - servicedating.db
    environment:
      - DATABASE_URL=postgresql://${POSTGRES_USER:-root}:${POSTGRES_PASSWORD:-root}@servicedating.db:5432/${POSTGRES_DB:-ccd}
    restart: always
